global:
  scrape_interval: 15s # 15초마다 수집

scrape_configs:
  # 1. GPU 서버 (Monitoring Hub & Target) - Docker Network 및 Host.docker.internal 이용
  - job_name: 'gpu-server'
    static_configs:
      - targets: ['host.docker.internal:9100'] # Node Exporter (Host Mode)
      - targets: ['dcgm-exporter:9400'] # DCGM Exporter (Container Mode)

  # 2. 일반 VM (Target) - 외부망(Public IP) 이용
  # 주의: 배포 시 'GENERAL_VM_IP_PLACEHOLDER'를 실제 General VM의 공인 IP로 변경해야 함.
  - job_name: 'general-vm'
    static_configs:
      - targets: ['GENERAL_VM_IP_PLACEHOLDER:9100'] 

  # 3. Backend API (FastAPI)
  # Nginx를 통해 노출된 메트릭 수집 (/api/metrics -> backend:8000/api/metrics)
  - job_name: 'backend-api'
    scrape_interval: 10s
    metrics_path: '/api/metrics'
    scheme: https
    static_configs:
      - targets: ['cukee.world'] # 실제 도메인 또는 IP

  # 4. AI Server API (FastAPI)
  # 같은 Docker Network 내에 있으므로 컨테이너명으로 접근 가능
  - job_name: 'ai-api'
    scrape_interval: 10s
    metrics_path: '/metrics'
    static_configs:
      - targets: ['ai-server:5000'] 
